% Chapter 1: Introduction 
\chapter{Introduction}

\section{Financial Background and Motivation}
Over the past decades, academic research and industry practice have documented a large "factor zoo" of asset pricing factors: firm characteristics like value, size, momentum, low-volatility, etc., that appear to explain stock returns. Traditional factor investing strategies select stocks based on these factors to earn expected return premiums. However, a critical challenge is that most factor-return relationships are established via statistical correlations, not proven causation. \textbf{LÃ³pez de Prado} warns that as long as factor investing remains at the correlation stage, it stays in an immature, phenomenological state\cite{Lopez23}. In other words, if investors pursue factors that merely \textit{co-move} with returns (perhaps due to hidden confounders or specific conditions) rather than truly \textit{cause} returns, the resulting strategies may fail when conditions change. Identifying which factors are genuine \emph{causal} drivers of returns is very importance to both researchers and practitioners. This thesis addresses that need by applying modern causal discovery algorithms to factor investing.

In empirical finance, establishing causality is very difficult: randomised trials are infeasible, and observational data analyses must handle problems like endogeneity (factors correlated with omitted variables or with returns themselves), selection bias, and structural breaks. Classic econometric techniques such as \textit{difference-in-differences} (DiD) and \textit{instrumental variables} (IV) estimation provide frameworks to infer causality under certain assumptions, but they can be challenging to apply and validate in complex financial settings. Additionally, many studies focus on average effects, potentially overlooking heterogeneity across the return distribution. \textbf{Optimal Transport (OT)} methods have recently emerged in fields like economics and machine learning as powerful tools to compare and adjust distributions, offering new ways to handle problems of matching, re-weighting, and counterfactual analysis\cite{Gunsilius21}\cite{Charpentier23}. This thesis explores the novel integration of OT with causal inference techniques to enhance their effectiveness in the factor investing domain.

\section{Problem Statement and Objectives}
The core question we investigate is: \emph{Can existing causal discovery algorithms, when applied to factor investing data, uncover meaningful cause-effect relationships, and does incorporating optimal transport into these methods yield deeper insights or improved reliability of those causal inferences?} To answer this, we conduct a proof-of-concept study using a fully synthetic dataset. By simulating an equity factor panel with known causal structure (where, for example, a momentum factor truly drives returns while a value factor does not), we have access to ground truth against which to evaluate each method's performance. 

This research has three main objectives:
\begin{enumerate}
    \item \textbf{Proof of Concept on Synthetic Data}: Create a realistic, simulated stock return dataset with embedded causal relationships. This allows careful testing of causal inference methods in a controlled environment.
    \item \textbf{Compare OT-Augmented vs Traditional Methods}: Apply established causal discovery techniques, including DiD, matching, and functional causal model approaches, both in their standard forms and with novel OT-based enhancements. We particularly benchmark against a classical IV approach as an econometric standard\cite{Athey16}, to assess whether the OT enhancements provide incremental insight beyond conventional methods.
    \item \textbf{Path to Real-World Application}: Show the value of these methods for factor investing and outline how this framework could be expanded and applied to real financial data in future work. This includes identifying which risk factors are genuine drivers of returns (and under what conditions), as a result guiding investors towards more robust, causally-informed strategies.
\end{enumerate}

\section{Approach and Contributions}
To achieve the above objectives, we employ a complete methodology that combines techniques from econometrics, machine learning, and optimal transport. We generate a panel dataset of stock returns influenced by multiple factors, ensuring the simulation feels realistic by calibrating factor correlations and volatilities to stylized facts from Fama-French data\cite{FamaFrench93}. Within this data, we embed known causal channels (e.g. momentum has a positive causal effect on returns, size and volatility have smaller effects, and value has no effect) as well as a \textit{treatment intervention} (a hypothetical event or policy that affects a subset of stocks partway through the sample) to introduce a causal effect and potential confounding. We then apply:
\begin{itemize}
    \item \textbf{Difference-in-Differences (DiD)} to estimate the causal effect of the intervention on returns, including a novel OT-based distributional DiD that considers the entire return distribution instead of just the mean.
    \item \textbf{Matching and Propensity Scores} to control for confounding differences between treated and control stocks, including an OT-based matching algorithm that optimally reweights observations for better covariate balance.
    \item \textbf{Instrumental Variables (IV)} analysis using synthetic instruments to address endogeneity (e.g. separating a factor's true effect from feedback effects).
    \item \textbf{Pairwise Causal Discovery algorithms}, specifically an Additive Noise Model (ANM) approach and the OT-based DIVOT method, to infer the direction of causality between each factor and returns.
\end{itemize}

By comparing the algorithms' outputs to the known ground truth in the simulation, we evaluate which methods successfully recover the true causal relationships and how the inclusion of OT influences their accuracy and robustness. We also perform robustness checks (such as placebo tests with fake interventions) to ensure that detected "causal" effects are not artifacts of model assumptions.

The main contributions of this thesis are: (1) demonstrating a unified framework to apply multiple causal discovery techniques to factor investing data, (2) introducing and testing OT enhancements that improve these methods' ability to handle distributional shifts and covariate imbalances, and (3) providing insights into which factors are likely genuine drivers of returns versus spurious correlations, informing the design of more robust factor-based investment strategies. Collectively, these contributions help advance factor investing research from a correlation-driven paradigm toward a causality-driven one.

\section{Thesis Outline}
The remainder of this thesis is organised as follows. Chapter~2 reviews the relevant literature on causal inference in finance and the integration of optimal transport into causal methods, positioning our work in the context of prior studies. Chapter~3 details the methodology and experimental setup, including data generation and the application of each causal discovery algorithm, and presents the empirical results of our simulations. We interpret the findings, discuss the performance and limitations of each method, and examine practical implications for investors. In Chapter~4, we conclude by summarising the key insights, acknowledging limitations of the study, and suggesting directions for future research, including steps needed to translate this proof-of-concept to real-world financial data. Finally, the Appendix provides supplementary information on data generation parameters, detailed results, and links to the complete code repository developed for this project\cite{AlameriGitHub2025}.